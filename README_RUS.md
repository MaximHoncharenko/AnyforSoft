# –í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –¥–≤–∏–∂–æ–∫ —Ä–∞—Å—á—ë—Ç–∞ –¥–Ω–µ–≤–Ω—ã—Ö –∫–æ–º–∏—Å—Å–∏–π –¥–ª—è MLM-—Å–µ—Ç–∏

–í—ã—Å–æ–∫–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ Python-—Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –¥–Ω–µ–≤–Ω—ã—Ö –∫–æ–º–∏—Å—Å–∏–π –≤ —Å–µ—Ç–∏ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ (MLM). –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫—Ä—É–ø–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å **–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é O(n)** –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞–º—è—Ç–∏.

## üéØ –û–±–∑–æ—Ä

–î–∞–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ –∫–æ–º–∏—Å—Å–∏–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤ –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç 5% –∫–æ–º–∏—Å—Å–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞–ª–æ–≤–æ–π –ø—Ä–∏–±—ã–ª–∏ –≤—Å–µ—Ö –∏—Ö –ø—Ä—è–º—ã—Ö –∏ –∫–æ—Å–≤–µ–Ω–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (–ø–æ—Ç–æ–º–∫–æ–≤).

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å O(n), –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 50K+ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤ –∑–∞ <2 —Å–µ–∫—É–Ω–¥—ã
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç ‚â§2x —Ä–∞–∑–º–µ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**: –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Ü–∏–∫–ª—ã, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–µ—Ä–µ–≤–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è —Å–µ—Ç–µ–π —Å 50K+ –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º–∏ –∏ 15+ —É—Ä–æ–≤–Ω—è–º–∏ –∏–µ—Ä–∞—Ä—Ö–∏–∏
- **–•–æ—Ä–æ—à–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω**: –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ —Å 16+ unit-—Ç–µ—Å—Ç–∞–º–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –∏–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
git clone <repository-url>
cd mlm-commission-engine

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt
```

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–º–∏—Å—Å–∏–∏ –∏–∑ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
python main.py --input dataset.json --output commissions.json

# –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
python main.py --input dataset.json --output commissions.json --verbose
```

### –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```json
[
  {
    "id": 1,
    "parent_id": null,
    "name": "–ü–∞—Ä—Ç–Ω—ë—Ä1",
    "monthly_revenue": 10000
  },
  {
    "id": 2,
    "parent_id": 1,
    "name": "–ü–∞—Ä—Ç–Ω—ë—Ä2", 
    "monthly_revenue": 5000
  }
]
```

### –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```json
{
  "1": 8.06,
  "2": 0.00
}
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º

### –û—Å–Ω–æ–≤–Ω–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º: Post-Order DFS —Å –º–µ–º–æ–∏–∑–∞—Ü–∏–µ–π

–î–≤–∏–∂–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–æ–±—Ö–æ–¥ –≤ –≥–ª—É–±–∏–Ω—É —Å –ø–æ—Å—Ç—Ñ–∏–∫—Å–Ω—ã–º –ø–æ—Ä—è–¥–∫–æ–º (Post-Order DFS)** –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ –∫–æ–º–∏—Å—Å–∏–π:

1. **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞**: O(n) - –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–≤—è–∑–µ–π —Ä–æ–¥–∏—Ç–µ–ª—å-—Ä–µ–±—ë–Ω–æ–∫ –∏–∑ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–æ–≤**: O(n) - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DFS —Å–æ —Å—Ç–µ–∫–æ–º —Ä–µ–∫—É—Ä—Å–∏–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–µ–≤–µ—Ä–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä  
3. **–†–∞—Å—á—ë—Ç –∫–æ–º–∏—Å—Å–∏–π**: O(n) - –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å—Ç—Ñ–∏–∫—Å–Ω—ã–π –æ–±—Ö–æ–¥ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∫–æ–º–∏—Å—Å–∏–∏

#### –ü–æ—á–µ–º—É Post-Order DFS?

- **–û–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö**: –î–µ—Ç–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –¥–æ —Ä–æ–¥–∏—Ç–µ–ª–µ–π
- **–û–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥**: –ö–∞–∂–¥—ã–π —É–∑–µ–ª –ø–æ—Å–µ—â–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑ - –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å O(n)
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å**: –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å O(h), –≥–¥–µ h - –≤—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞
- **–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –º–µ–º–æ–∏–∑–∞—Ü–∏—è**: –ü—Ä–∏–±—ã–ª—å –ø–æ–¥–¥–µ—Ä–µ–≤—å–µ–≤ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

#### –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã

| –ü–æ–¥—Ö–æ–¥ | –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å | –ü–∞–º—è—Ç—å | –ü–ª—é—Å—ã | –ú–∏–Ω—É—Å—ã |
|--------|-------------------|--------|-------|--------|
| **Post-Order DFS** ‚≠ê | **O(n)** | **O(h)** | –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ | –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å—Ç–µ–∫ |
| Bottom-Up DP | O(n) | O(n) | –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π | –°–ª–æ–∂–Ω–æ–µ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π |
| Top-Down DFS | O(n¬≤) | O(h) | –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ | –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è |
| BFS –ø–æ —É—Ä–æ–≤–Ω—è–º | O(n) | O(w) | –•–æ—Ä–æ—à –¥–ª—è —à–∏—Ä–æ–∫–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤ | –°–ª–æ–∂–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è |

### –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

- **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞**: O(n) - –û–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–≤—è–∑–µ–π
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–æ–≤**: O(V + E) = O(n) - DFS –Ω–∞ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ  
- **–†–∞—Å—á—ë—Ç –∫–æ–º–∏—Å—Å–∏–π**: O(n) - –ö–∞–∂–¥—ã–π —É–∑–µ–ª –ø–æ—Å–µ—â–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞**: O(n) - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–ò—Ç–æ–≥–æ: O(n), –≥–¥–µ n = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤**

### –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

- **–•—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤**: O(n) - –•—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞**: O(n) - –°–≤—è–∑–∏ —Ä–æ–¥–∏—Ç–µ–ª—å-—Ä–µ–±—ë–Ω–æ–∫
- **–°—Ç–µ–∫ —Ä–µ–∫—É—Ä—Å–∏–∏**: O(h) - –ì–¥–µ h - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞
- **–í—ã–≤–æ–¥**: O(n) - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ–º–∏—Å—Å–∏–π

**–ò—Ç–æ–≥–æ: O(n + h) ‚âà O(n) –¥–ª—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–µ—Ä–µ–≤—å–µ–≤**

## üìä –ë–µ–Ω—á–º–∞—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞
- **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä**: 4-—è–¥–µ—Ä–Ω—ã–π 3.0 –ì–ì—Ü (–∏–ª–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç)
- **–ü–∞–º—è—Ç—å**: 8 –ì–ë
- **Python**: 3.11+
- **–û–°**: Windows/Linux/macOS

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–Ω—á–º–∞—Ä–∫–æ–≤

| –ü–∞—Ä—Ç–Ω—ë—Ä—ã | –í—Ä–µ–º—è (—Å) | –ü–∞—Ä—Ç–Ω—ë—Ä–æ–≤/—Å–µ–∫ | –ü–∞–º—è—Ç—å (–ú–ë) | –°—Ç–∞—Ç—É—Å |
|----------|----------|---------------|-------------|---------|
| 100      | 0.001    | 100,000       | 1.2         | ‚úÖ      |
| 500      | 0.003    | 166,667       | 2.1         | ‚úÖ      |
| 1,000    | 0.006    | 166,667       | 3.8         | ‚úÖ      |
| 5,000    | 0.028    | 178,571       | 15.2        | ‚úÖ      |
| 10,000   | 0.055    | 181,818       | 28.7        | ‚úÖ      |
| 25,000   | 0.142    | 176,056       | 68.9        | ‚úÖ      |
| **50,000** | **0.287** | **174,216** | **132.4** | **‚úÖ <2—Å** |

### –ó–∞–ø—É—Å–∫ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
python benchmark.py

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ benchmark_results.json
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
pytest test_commission_engine.py -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest test_commission_engine.py --cov=commission_engine --cov-report=html

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤
pytest test_commission_engine.py -k "test_cycle" -v
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å**: –ü—Ä–æ—Å—Ç—ã–µ –∏ —Å–ª–æ–∂–Ω—ã–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–µ—Ç–∏, –ª–µ—Å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ **–ö—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏**: –û–¥–∏–Ω –ø–∞—Ä—Ç–Ω—ë—Ä, –ª–∏—Å—Ç–æ–≤—ã–µ —É–∑–ª—ã, –≥–ª—É–±–æ–∫–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ (10+ —É—Ä–æ–≤–Ω–µ–π)
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–æ–≤, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–∏, –Ω–µ–≤–µ—Ä–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ **–¢–æ—á–Ω–æ—Å—Ç—å**: –î–µ–Ω–µ–∂–Ω—ã–µ —Ä–∞—Å—á—ë—Ç—ã —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ 2 –∑–Ω–∞–∫–æ–≤
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ì–ª—É–±–æ–∫–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏, –±–æ–ª—å—à–∏–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –°–∫–≤–æ–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤

## üè¢ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞—Å—á—ë—Ç–∞ –∫–æ–º–∏—Å—Å–∏–π

1. **5% —Å—Ç–∞–≤–∫–∞ –∫–æ–º–∏—Å—Å–∏–∏**: –ö–∞–∂–¥—ã–π –ø–∞—Ä—Ç–Ω—ë—Ä –ø–æ–ª—É—á–∞–µ—Ç 5% —Å –≤–∞–ª–æ–≤–æ–π –ø—Ä–∏–±—ã–ª–∏ –ø–æ—Ç–æ–º–∫–æ–≤
2. **–î–Ω–µ–≤–Ω–æ–π —Ä–∞—Å—á—ë—Ç**: `–¥–Ω–µ–≤–Ω–∞—è_–ø—Ä–∏–±—ã–ª—å = –º–µ—Å—è—á–Ω–∞—è_–≤—ã—Ä—É—á–∫–∞ / –¥–Ω–∏_–≤_–º–µ—Å—è—Ü–µ`
3. **–ê–¥–¥–∏—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ö–æ–º–∏—Å—Å–∏–∏ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è –ø–æ –≤—Å–µ–º –ø–æ—Ç–æ–º–∫–∞–º –Ω–∞ –ª—é–±–æ–º —É—Ä–æ–≤–Ω–µ
4. **–ë–µ–∑ –≤—ã—á–µ—Ç–æ–≤**: –ü–æ—Ç–æ–º–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å–≤–æ—é –ø–æ–ª–Ω—É—é –ø—Ä–∏–±—ã–ª—å
5. **–¢–æ—á–Ω–æ—Å—Ç—å**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–∫—Ä—É–≥–ª—è—é—Ç—Å—è –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á—ë—Ç–∞

```
–ö–æ—Ä–µ–Ω—å (–º–µ—Å—è—á–Ω–æ: $3,100 = $100/–¥–µ–Ω—å)
‚îú‚îÄ‚îÄ –†–µ–±—ë–Ω–æ–∫1 (–º–µ—Å—è—á–Ω–æ: $1,550 = $50/–¥–µ–Ω—å)  
‚îÇ   ‚îî‚îÄ‚îÄ –í–Ω—É–∫ ($620 = $20/–¥–µ–Ω—å)
‚îî‚îÄ‚îÄ –†–µ–±—ë–Ω–æ–∫2 ($930 = $30/–¥–µ–Ω—å)

–ö–æ–º–∏—Å—Å–∏–∏:
- –ö–æ—Ä–µ–Ω—å: 5% √ó ($50 + $20 + $30) = $5.00
- –†–µ–±—ë–Ω–æ–∫1: 5% √ó $20 = $1.00  
- –†–µ–±—ë–Ω–æ–∫2: 5% √ó $0 = $0.00
- –í–Ω—É–∫: 5% √ó $0 = $0.00
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
mlm-commission-engine/
‚îú‚îÄ‚îÄ commission_engine.py    # –û—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–≤–∏–∂–∫–∞
‚îú‚îÄ‚îÄ main.py                # CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å  
‚îú‚îÄ‚îÄ test_commission_engine.py # –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ benchmark.py           # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ dataset.json          # –û–±—Ä–∞–∑–µ—Ü —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ README.md             # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üîß –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ API

### –ö–ª–∞—Å—Å CommissionEngine

```python
from commission_engine import CommissionEngine

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–≤–∏–∂–∫–∞
engine = CommissionEngine()

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
engine.load_partners(partner_data)      # –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞
engine.calculate_daily_profits()        # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –º–µ—Å—è—á–Ω—ã–µ –≤ –¥–Ω–µ–≤–Ω—ã–µ
commissions = engine.calculate_commissions()  # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ –∫–æ–º–∏—Å—Å–∏–∏

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
engine.process_file("input.json", "output.json")

# –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–µ—Ç–∏  
stats = engine.get_stats()
```

### CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```bash
python main.py --help

–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: main.py [-h] --input INPUT --output OUTPUT [--verbose]

–†–∞—Å—á—ë—Ç –¥–Ω–µ–≤–Ω—ã—Ö –∫–æ–º–∏—Å—Å–∏–π –¥–ª—è —Å–µ—Ç–∏ MLM –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤

–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã:
  -h, --help            –ø–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–ø—Ä–∞–≤–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤—ã–π—Ç–∏
  --input INPUT, -i INPUT
                        –í—Ö–æ–¥–Ω–æ–π JSON —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤
  --output OUTPUT, -o OUTPUT  
                        –í—ã—Ö–æ–¥–Ω–æ–π JSON —Ñ–∞–π–ª –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–æ–º–∏—Å—Å–∏–π
  --verbose, -v         –í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
```

## üõ°Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–î–≤–∏–∂–æ–∫ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥—ë–∂–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–∞—Ö:

- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–æ–≤**: –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**: –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫
- **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- **–§–∞–π–ª–æ–≤—ã–π –≤–≤–æ–¥/–≤—ã–≤–æ–¥**: –ß—ë—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **–ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–µ**: O(n) post-order DFS –≤–º–µ—Å—Ç–æ –Ω–∞–∏–≤–Ω—ã—Ö O(n¬≤) –ø–æ–¥—Ö–æ–¥–æ–≤
2. **–ü–∞–º—è—Ç—å**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞–∫–ª–∞–¥–Ω—ã–º–∏ —Ä–∞—Å—Ö–æ–¥–∞–º–∏
3. **–¢–æ—á–Ω–æ—Å—Ç—å**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Python Decimal –∏–∑–±–µ–≥–∞–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ float —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º)
4. **–í–≤–æ–¥/–≤—ã–≤–æ–¥**: –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ JSON –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
5. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û–¥–Ω–æ–ø—Ä–æ—Ö–æ–¥–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ä–∞—Å—á—ë—Ç–∞–º–∏ –ø–æ–¥–¥–µ—Ä–µ–≤—å–µ–≤

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –ª–µ—Å–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä
- **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–π/—É–¥–∞–ª–µ–Ω–∏–π –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤  
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ**: –ú–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω—ã–µ —Ä–∞—Å—á—ë—Ç—ã –∫–æ–º–∏—Å—Å–∏–π
- **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**: –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤
